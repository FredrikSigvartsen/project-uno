;(function ($) {

  <% unless Rails.env.production? %>
    Pusher.log = function(message) {
      if (window.console && window.console.log) {
        window.console.log(message);
      }
    };
  <% end %>

  var pusher = new Pusher('0d846fc26187e9741029');
  var channel = pusher.subscribe('chat');

  pusher.connection.bind('connected', function () {
    var socket_id = pusher.connection.socket_id;

    $('#socket_id').val(socket_id);
  });

  channel.bind('new_message', function (data) {
    $('.messages').append('<div style="clear: left;>'+'<p style="float: left;">'+ 
      '<img src="https://s-media-cache-ak0.pinimg.com/236x/3b/57/0c/3b570c039bfc8640276ede7e3f5d778c.jpg" alt="avatarMessage" width="13" height="13">'+
      '<font color="black">' + '(' + data.timestamp +') '+ data.name + ': ' + 
      '</font>' + data.message + '</p>'+ '</div>');
      $('.messages').animate({ 
        scrollTop: $('.messages')[0].scrollHeight}, 2000);
  });
}(jQuery));
